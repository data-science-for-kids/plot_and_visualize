<!DOCTYPE html>
<html>
<head>

  <meta charset="utf-8">

  <meta http-equiv="X-UA-Compatible" content="IE=edge">

  <title>Data Science for Kids</title>

  <!-- Tell the browser to be responsive to screen width -->

  <meta content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" name="viewport">

  <!-- Bootstrap 3.3.6 -->
<link rel="shortcut icon" href="favicon.ico" type="image/x-icon">
  <link rel="stylesheet" href="bootstrap/css/bootstrap.min.css">

  <!-- Font Awesome -->

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.5.0/css/font-awesome.min.css">

  <!-- Ionicons -->

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/ionicons/2.0.1/css/ionicons.min.css">

  <!-- Theme style -->
  <link rel="stylesheet" href="dist/css/AdminLTE.min.css">
  <link rel="stylesheet" href="dist/css/skins/skin-red.min.css">
<style>
.chart {
  width: 100%; 
  min-height: 228px;
}
#innerBtn,#playBtn,#inputNo{
    display: table;
    margin: 0 auto;
}
#Chart,#carousel_div{
  display: none;
}

#snackbar,#snackbar_incorrect {
    visibility: hidden; /* Hidden by default. Visible on click */
    min-width: 250px; /* Set a default minimum width */
    margin-left: -125px; /* Divide value of min-width by 2 */
    background-color: #333; /* Black background color */
    color: #fff; /* White text color */
    text-align: center; /* Centered text */
    border-radius: 2px; /* Rounded borders */
    padding: 16px; /* Padding */
    position: fixed; /* Sit on top of the screen */
    z-index: 1; /* Add a z-index if needed */
    left: 50%; /* Center the snackbar */
    bottom: 30px; /* 30px from the bottom */
}

/* Show the snackbar when clicking on a button (class added with JavaScript) */
#snackbar.show,#snackbar_incorrect.show {
    visibility: visible; /* Show the snackbar */

/* Add animation: Take 0.5 seconds to fade in and out the snackbar. 
However, delay the fade out process for 2.5 seconds */
    -webkit-animation: fadein 0.5s, fadeout 0.5s 2.5s;
    animation: fadein 0.5s, fadeout 0.5s 2.5s;
}

/* Animations to fade the snackbar in and out */
@-webkit-keyframes fadein {
    from {bottom: 0; opacity: 0;} 
    to {bottom: 30px; opacity: 1;}
}

@keyframes fadein {
    from {bottom: 0; opacity: 0;}
    to {bottom: 30px; opacity: 1;}
}

@-webkit-keyframes fadeout {
    from {bottom: 30px; opacity: 1;} 
    to {bottom: 0; opacity: 0;}
}

@keyframes fadeout {
    from {bottom: 30px; opacity: 1;}
    to {bottom: 0; opacity: 0;}
}
</style>
</head>
<body class="hold-transition skin-red layout-top-nav">
<script src="plugins/jQuery/jquery-2.2.3.min.js"></script>
<!-- Bootstrap 3.3.6 -->
<script src="bootstrap/js/bootstrap.min.js"></script>
<!-- AdminLTE App -->
<script src="dist/js/app.min.js"></script>

<div class="wrapper">
  <div class="content-wrapper">
    <section class="content-header">
        <div class="box box-solid" id="chartHolder">
            <div class="box-header with-border">
              <h3 class="box-title">Data Science for Kids</h3>
              <div class="box-tools pull-right">
                <button type="button" class="btn btn-box-tool" data-widget="collapse"><i class="fa fa-minus"></i>
                </button>
              </div>
            </div>
            <div class="box-body" >
              <div class="row">
                <div class="col-md-8">
                  
                  <div class="col-md-10">

                    <div class="chart" id="Chart"></div>

                    <div id="carousel_div" class="carousel slide" data-ride="carousel" onclick="open_chart()">
                      <ol class="carousel-indicators">
                        <li data-target="#carousel_div" data-slide-to="0" class="active"></li>
                        <li data-target="#carousel_div" data-slide-to="1" class=""></li>
                        <li data-target="#carousel_div" data-slide-to="2" class=""></li>
                      </ol>
                      <div class="carousel-inner">
                        <div class="item active">
                          <img src="slide1.png" alt="First slide">
                          <div class="carousel-caption">
                            Click to Play
                          </div>
                        </div>
                        <div class="item">
                          <img src="slide1.png" alt="Second slide">

                          <div class="carousel-caption">
                            Click to Play
                          </div>
                        </div>
                        <div class="item">
                          <img src="slide1.png" alt="Third slide">

                          <div class="carousel-caption">
                            Click to Play
                          </div>
                        </div>
                      </div>
                      <a class="left carousel-control" href="#carousel_div" data-slide="prev">
                        <span class="fa fa-angle-left"></span>
                      </a>
                      <a class="right carousel-control" href="#carousel_div" data-slide="next">
                        <span class="fa fa-angle-right"></span>
                      </a>
                    </div>


                  <a class="btn btn-app" onClick="welcome()" id="playBtn">
                      <i class="fa fa-play"></i> Play
                  </a>
                  
                  </div>
                  <!-- /.chart-responsive -->
                </div>
                <!-- /.col -->
                <div class="col-md-2" id="table_div"> 
                  
                </div>
                <!-- /.col -->
              </div>
              <!-- /.row -->
              <div class="box-body">
                <div class="row">
                    <td>
                    <div class="btn-group" id="innerBtn">
                      <button type="button" class="btn btn-danger" onclick="prev()" id="prevBtn">Prev</button>
                      <button type="button" class="btn btn-danger" onclick="chartLine()" id="saveBtn">Plot</button>
                      <button type="button" class="btn btn-danger" onclick="next()" id="nextBtn">Next</button>
                    </div>
                  </td>
                </div>
              </div>
            </div>
            <!-- ./box-body -->
            <div class="box-footer">
              <div class="row">
                <div class="col-sm-3 col-xs-6">
                  <div class="box box-danger">
                    <h5 class="description-header" id="score"><b>0</b></h5>
                    <span class="description-text">SCORE</span>
                  </div>
                  <!-- /.description-block -->
                </div>
                <!-- /.col -->
                <div class="col-sm-3 col-xs-6">
                  <div class="box box-danger">
                    <h5 class="description-header" id="life"><b>3</b></h5>
                    <span class="description-text">LIVES LEFT</span>
                  </div>
                  <!-- /.description-block -->
                </div>
                <!-- /.col -->
                <div class="col-sm-3 col-xs-6">
                  <div class="box box-danger">
                    <h5 class="description-header" id="level"><b>0</b></h5>
                    <span class="description-text">LEVEL</span>
                  </div>
                  <!-- /.description-block -->
                </div>
                <!-- /.col -->
                <div class="col-sm-3 col-xs-6">
                  <div class="box box-danger">
                    <h5 class="description-header"><b>Easy</b></h5>
                    <span class="description-text">DIFFICULTY</span>
                  </div>
                </div>
              </div>
            </div>
          </div>  
    </section>
</div>
    <!-- Main content -->
    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>

    <script type="text/javascript">
      
      $(document).ready(function(){ 
          $("#nextBtn").prop("disabled",true); 
          $("#prevBtn").prop("disabled",true);
       });

      google.charts.load("current", {packages:["corechart"]});
      google.charts.load("current", {packages:["table"]});
    
      var chart  = null,chartS = null,table = null;   
      var index = 0;
      var curr = null;
      var data = null, dataTable = null,dataS = null;  
      var lives = 7;
      var level=1;
      var score=0;
      var chartArray=[['X','Y']];
      var x=0;
      var flag = true; 

      function answer(){
              var ans = [16, 40, 1, 25, 21, 15];
              return ans[index];
      }
      function max_arr(){
              var max_a = [18, 40, 8, 30, 21, 60];
              return max_a[index];
      }   

      function setModal(){
              
              var str="";
              var arr = makeData();

              arr.forEach(function(val) {
                if(val[1] != 0){
                  str=str+val[1]+" , ";
                }
              });
              
              if(index > 0){
              document.getElementById('modal_title').innerHTML = 'Great Job, Now complete this...';
              console.log('set');
              }
              else{
               document.getElementById('modal_title').innerHTML = 'Lets play a game! What Comes next in the series ?'; 
              }
              
              document.getElementById('modal_body').innerHTML = str+" ?";

              $("#myModalHorizontal").modal("show");

        }

       function checkanswer(){

              x=document.getElementById('inputNo').value;
              ans=answer();
              if(ans == x){
                  console.log('Correct');
                  var snack = document.getElementById("snackbar")
                  snack.className = "show";
                  setTimeout(function(){ snack.className = snack.className.replace("show", ""); chartLine();}, 3000);
              }
              else{
                    chartScatter();
                    var snack = document.getElementById("snackbar_incorrect")
                    snack.className = "show";
                    setTimeout(function(){ snack.className = snack.className.replace("show", "");}, 3000);
              }
      }
      function getOptions(){
              var a=makeData();
              var top=max_arr();
              dataS = google.visualization.arrayToDataTable([['X', 'Y'],['', 0]]);
              options = {
                 legend: 'none',
                 height: 228,
                 width: "100%",
                 hAxis: {
                          viewWindow: { min: 0, max: 9},
                          ticks: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]
                        },
                 vAxis: {
                          viewWindow: { min: 0, max: top},
                          ticks: [a[0][1],a[1][1],a[2][1],a[3][1],a[4][1],a[5][1],a[6][1]]
                        },
                 colors: ['#795548'],
                 pointSize: 20,
                 animation:{ startup:true, duration: 500, easing: 'linear'},
                 pointShape: 'star',
                 backgroundColor: { fill:'transparent' }};
      }

      function chartScatter(){
              getOptions();
              document.getElementById('life').innerHTML = lives; 
              document.getElementById('level').innerHTML = level;  
              document.getElementById('score').innerHTML = score;
              chartS = new google.visualization.ScatterChart(document.getElementById('Chart'));
              chartS.draw(dataS,options);
              var temp = makeData();
              drawTables(temp);
              google.visualization.events.addListener(chartS, 'select', selectHandler); 
        }

      function addData(x,y) {
              var ans = answer();
              if(y == 0)
                y = ans;
              chartArray.push([x,y]);    
              dataS = google.visualization.arrayToDataTable
                    (chartArray);
              chartS.draw(dataS,options);;
      }

      function chartLine() { 
              getOptions();
              var a = makeData();    
              var ans = answer();  
              data = google.visualization.arrayToDataTable([ ['X', 'Y'],a[0],a[1],a[2],a[3],a[4],a[5],a[6],[8,ans]]);
                chart = new google.visualization.LineChart(document.getElementById('Chart'));
                chart.draw(data, options);
                  var temp = makeData();
                  drawTables(temp);
                google.visualization.events.addListener(chart, 'select', selectHandlerLine);
              document.getElementById('nextBtn').disabled=false;
      }
  
      function makeData(){
              var arr=[
                 [ [1, 2],[2, 4], [3, 6], [4, 8], [5, 10],[6, 12],[7, 14],[8, 0]] ,
                 [ [1, 5],[2, 10],[3, 15],[4, 20],[5, 25],[6, 30],[7, 35],[8, 0] ],
                 [ [1, 8],[2, 7], [3, 6], [4, 5], [5, 4], [6, 3], [7, 2], [8, 0] ],
                 [ [1, 5],[2, 10],[3, 5], [4, 15],[5, 5], [6, 20],[7, 5], [8, 0] ],
                 [ [1, 1],[2, 1], [3, 2], [4, 3], [5, 5], [6, 8], [7, 13],[8, 0] ],
                 [ [1, 0],[2, 15],[3, 30],[4, 45],[5, 60],[6, 45],[7, 30],[8, 0] ]
                ];

                return arr[index];
      }
      function next(){
              flag=true;
              var snack = document.getElementById("snackbar")
              snack.className = "show";
              setTimeout(function(){ snack.className = snack.className.replace("show", ""); setModal();  }, 3000);

              document.getElementById('prevBtn').disabled = false;
              document.getElementById('nextBtn').disabled = true;
              index=index+1;
              level=level+1;
              score=score+100;

              chartArray=[['X','Y']];

              console.log('Index = '+index);

              if(index == 6){
                alert('Congratulations, you have finished the test!');
                new_();
                return;
              }              
      }
      function new_(){
              index=0;
              level=1;
              lives=3;
              score=0;
              chartArray=[['X','Y']];
              checkanswer();
              setModal();
      }
      function prev(){
              document.getElementById('nextBtn').disabled=false;
              index=index-1;
              chartScatter();
              chartArray=[['X','Y']];
              if(index == 0)
                document.getElementById('prevBtn').disabled=true;
      }
      function drawTables(arr){
              var table_arr=[];

              arr.forEach(function(e) {
              table_arr.push([e[0],e[1].toString(),flag]);
              });

              dataTable = new google.visualization.DataTable();
              dataTable.addColumn('number', '#');
              dataTable.addColumn('string', 'Number');
              dataTable.addColumn('boolean', 'Select');
              dataTable.addRows(table_arr);

              dataTable.setCell(7,1,'<input type="number" class="form-control" id="table_ans" placeholder="Answer"/>');

              table = new google.visualization.Table(document.getElementById('table_div'));
              google.visualization.events.addListener(table,'select',tableHandler);

              var formatter = new google.visualization.ColorFormat();

              formatter.addGradientRange(0, max_arr(), 'black', '#32ff4a','#ff3232');
              formatter.format(dataTable, 0);
              formatter.format(dataTable, 1);
              formatter.format(dataTable, 2);

              table.draw(dataTable, {allowHtml: true,showRowNumber: false, width: '100%', height: '100%'});
      }
      function tableHandler(e){

              var selectedItem=table.getSelection()[0];
              var temp=makeData();
              if (selectedItem) {
                var topping = dataTable.getValue(selectedItem.row, 1);     
                if(selectedItem.row == 7){
                  if(document.getElementById('table_ans').value == ans){
                    document.getElementById('nextBtn').disabled = false;
                    topping=ans; 
                  }
                }
                addData(selectedItem.row+1,parseInt(topping));
              }
      }
      function selectHandler() {      
              var selectedItem = chartS.getSelection()[0];
              if (selectedItem) {
                x = dataS.getValue(selectedItem.row, selectedItem.column);

                if(x == ans){
                    var temp = makeData();
                    curr = [temp[0],temp[1],temp[2],temp[3],temp[4],temp[5],temp[6],[8,x]];
                    drawTables(curr);
                    document.getElementById('nextBtn').disabled = false;
                    }
                else{
                  lives=lives-1;
                  document.getElementById('life').innerHTML = lives;
                }

              if(lives == 0){
                  alert('Game Over');
                  new_();
              }

                }
        } 
      function selectHandlerLine() {      

              var selectedItem = chart.getSelection()[0];
              if (selectedItem) {
                  x = data.getValue(selectedItem.row, selectedItem.column);
                 if(x == ans){
                      var temp = makeData();
                      curr = [temp[0],temp[1],temp[2],temp[3],temp[4],temp[5],temp[6],[8,x]];
                      drawTables(curr);
                      document.getElementById('nextBtn').disabled = false;
                      }
                  else{
                      lives=lives-1;
                      document.getElementById('life').innerHTML = lives;
                    }
                  if(lives == 0){
                      alert('Game Over');
                      new_();
                }
              } 
      }
      function welcome(){
              $('#carousel_div').show(); //class selector for the div to show
              $('#Chart').hide()
              $('#playBtn').hide();
      }

      function open_chart(){
              $('#carousel_div').hide(); //class selector for the div to show
              $('#Chart').show()
              setModal();
      }

          
      // (function($,sr){
      //       var debounce = function (func, threshold, execAsap) {
      //       var timeout;

      //       return function debounced () {
      //           var obj = this, args = arguments;
      //           function delayed () {
      //               if (!execAsap)
      //                   func.apply(obj, args);
      //               timeout = null;
      //           };

      //           if (timeout)
      //               clearTimeout(timeout);
      //           else if (execAsap)
      //               func.apply(obj, args);

      //           timeout = setTimeout(delayed, threshold || 100);
      //       };
      //     }
      //       jQuery.fn[sr] = function(fn){  return fn ? this.bind('resize', debounce(fn)) : this.trigger(sr); };
      //     })(jQuery,'smartresize');

      //       $(window).smartresize(function(){
      //         chartScatter();
      //       });    
        </script>
             
          <div id="snackbar">Correct Answer..</div>
          <div id="snackbar_incorrect">Sorry! Wrong answer</div>

          <div class="modal modal-danger" id="myModalHorizontal" tabindex="-1" role="dialog" 
                                    aria-labelledby="myModalLabel" aria-hidden="true">
              <div class="modal-dialog">
                  <div class="modal-content">
                      <!-- Modal Header -->
                      <div class="modal-header">
                          
                          <h4 class="modal-title" id="modal_title">
                              Lets play a game! What Comes next in the series ?
                          </h4>
                      </div>
                      <!-- Modal Body -->
                      <div class="modal-body">
                          
                          <form class="form-horizontal" role="form">
                            <div class="form-group">
                              <label  class="col-sm-7 control-label" id="modal_body">Number</label>
                              <br><br>
                              <div class="col-sm-10">
                                  <input type="number" class="form-control" 
                                  id="inputNo" placeholder="Answer" style="width:100px;"/>
                              </div>
                            </div>
                          </form>
                      </div>
                      
                      <!-- Modal Footer -->
                      <div class="modal-footer">
                          <button type="button" class="btn btn-outline" 
                          data-dismiss="modal" onclick="checkanswer()">Visualize</button>
                      </div>
                  </div>
              </div> 
          </div>
        </div>
      </div>

</div>
</body>
</html>